import { exec } from 'child_process'; export default async function handler(req,res){ const secret = req.query.secret || req.headers['x-cron-secret']; if(!secret || secret !== process.env.CRON_SECRET) return res.status(401).json({error:'unauthorized'}); exec('node scripts/generatePosts.js', { cwd: process.cwd() }, (err, stdout, stderr)=>{ if(err){ console.error(stderr); return res.status(500).json({error: stderr || 'generation failed'}) } return res.status(200).json({ok:true, output: stdout}) }) }